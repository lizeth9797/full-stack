{"ast":null,"code":"var _jsxFileName = \"/home/karina/bedu/System-Rentail/app/src/components/Details2.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport '../public/styles/details.sass';\nimport Link from '@mui/material/Link';\nimport List from '@mui/material/List';\nimport ListItem from '@mui/material/ListItem';\nimport ListItemText from '@mui/material/ListItemText';\nimport { AlertDialog } from './Confirm';\nimport { MaterialUIPickers } from './DatePicker';\nimport { BasicAlerts } from './Alert';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst evalStatus = estatus => {\n  return estatus == 'En Espera' ? true : false;\n};\n\nexport function Details(props) {\n  _s();\n\n  const [data, setData] = useState([]);\n  const [open, setOpen] = useState(false);\n  const [responseMessage, setResponseMessage] = useState('Holi :)');\n  const [responseSeverity, setSeverity] = useState('success');\n  const [alertVisibility, setAlertVisibility] = useState(false);\n  const [activeRRN, setActiveRRN] = useState('');\n  const [activeRRI, setActiveRRI] = useState(''); //console.log(`Este es el id: ${props.idRR}`)\n\n  const [value, setValue] = React.useState(new Date());\n\n  const handleChange = newValue => {\n    setValue(newValue); //console.log(newValue)\n  };\n\n  let type = '';\n  let typeLess = '';\n  let lessee;\n  let lessor;\n\n  if (props.type == 'lessee') {\n    typeLess = props.req.id_lessor;\n    type = 'Arrendador';\n    lessee = true;\n    lessor = false;\n  } else {\n    typeLess = props.req.id_lessee;\n    type = 'Arrendatario';\n    lessee = false;\n    lessor = true;\n  }\n\n  URL = `https://system-rentail-api.herokuapp.com/users/${typeLess}`; //console.log(`Dta: ${URL}`)\n\n  useEffect(() => {\n    const getData = async url => {\n      const config = {\n        \"Authorization\": \"Bearer \" + \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjYxN2FlMTRlM2E0MGFhMDAxNjI5NzBhOCIsInVzZXJuYW1lIjoiam5hbWUiLCJleHAiOjE2NDA2MjcwMjIsImlhdCI6MTYzNTQ0MzAyMn0.BxY-c14bn3198yT_tqVmVqywFbXMpdk2Mm2IwGNM0EE\"\n      }; //localStorage.setItem('TOKEN', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjYxNGNkZGUzNTFkZTkxMDAxNjJhMGJjMiIsInVzZXJuYW1lIjoibWFyaSIsImV4cCI6MTY0MTQxNDQ2OSwiaWF0IjoxNjM2MjMwNDY5fQ.snhZQ-80qf7TNCnwA-Xo0B9lTUk2q5itMIIKW2Z1v1Y')\n\n      try {\n        const response = await fetch(url, {\n          headers: config\n        });\n        const data = await response.json(); //console.log(data)\n\n        setData(data);\n      } catch (err) {\n        console.log(err);\n      }\n    };\n\n    getData(URL);\n  }, []);\n\n  function addDays(date, days) {\n    const copy = new Date(Number(date));\n    copy.setDate(date.getDate() + days);\n    return copy;\n  }\n\n  const confirm = e => {\n    //console.log('Botón presionado')\n    setOpen(true); //console.log('Nombre del botón:::')\n    //console.log(e.target.name)\n\n    setActiveRRN(e.target.name);\n    setActiveRRI(e.target.id);\n  };\n\n  const accept = () => {\n    //console.log('Aceptado')\n    handleClick();\n    setOpen(false);\n  };\n\n  const cancel = () => {\n    //console.log('Cancelado')\n    setOpen(false);\n  }; // Queda pendiente lo del target\n\n\n  const handleClick = () => {\n    const ref = activeRRI; //e.target.id;\n\n    console.log(ref); //console.log('Nombre del botón:::')\n    //console.log(activeRRN)\n    //const token = localStorage.getItem('TOKEN');\n    //\n\n    const sUser = JSON.parse(localStorage.getItem('user'));\n    const token = sUser.token;\n    const idRequest = activeRRN; //e.target.name\n\n    const urlUpdateRequest = 'https://system-rentail-api.herokuapp.com/rental-requests/' + idRequest + '/' + ref;\n    const urlConfirmRequest = 'https://system-rentail-api.herokuapp.com/rents'; //console.log('Test de Fechas')\n\n    let numberOfDays = props.req.contract.days; // Aquí poner el total de días del contrato\n\n    const periodo = props.req.contract.period;\n    numberOfDays = !numberOfDays ? periodo : numberOfDays;\n    numberOfDays = !numberOfDays ? 0 : numberOfDays;\n\n    const formattedDate = date => {\n      const fecha = date;\n      const day = fecha.getDate();\n      const month = fecha.getMonth() + 1;\n      const year = fecha.getFullYear();\n      const realMonth = month < 10 ? `0${month}` : `${month}`;\n      const realDay = day < 10 ? `0${day}` : `${day}`;\n      const completeDate = `${year},${realMonth},${realDay}`;\n      return completeDate;\n    }; // De la fecha seleccionada empieza a correr al siguiente día\n\n\n    const date = addDays(value, 1);\n    console.log(date);\n    const startDate = formattedDate(date);\n    console.log(startDate);\n    const finalDate = addDays(date, numberOfDays);\n    const ffinalDate = formattedDate(finalDate);\n    console.log(ffinalDate);\n    console.log('End de Fechas');\n\n    const updateStatus = async url => {\n      const config = {\n        method: \"PUT\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          \"Authorization\": \"Bearer \" + token\n        }\n      };\n\n      try {\n        const response = await fetch(url, config);\n        console.log(response);\n        const data = await response.json();\n        const resSev = response.status == '200' ? 'success' : 'error';\n        setSeverity(resSev);\n        setAlertVisibility(true);\n        setResponseMessage(data.message); //console.log(data)\n      } catch (err) {\n        console.log(err);\n      }\n    }; // Esta se llama solo en caso de que quiera confirmar\n\n\n    const confirmRequest = async url => {\n      const dataForRent = {\n        \"id_rentalRequest\": `${activeRRN}`,\n        \"start_date\": `${startDate}`,\n        \"end_date\": `${ffinalDate}`\n      };\n      console.log('Datos a Enviar: ');\n      console.log(dataForRent);\n      const config = {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          \"Authorization\": \"Bearer \" + token\n        },\n        body: JSON.stringify(dataForRent)\n      };\n\n      try {\n        const response = await fetch(url, config);\n        const data = await response.json();\n        const resSev = response.status == '200' ? 'success' : 'error';\n        setSeverity(resSev);\n        setAlertVisibility(true);\n        setResponseMessage(data.message); //console.log(data)\n      } catch (err) {\n        console.log(err);\n      }\n    }; // Si lo que quiere es confirmar entonces se llama a crear Renta, sino, simplemente actualiza estatus\n\n\n    if (ref == '2') {\n      console.log('Quiere confirmar');\n      confirmRequest(urlConfirmRequest);\n    } else {\n      updateStatus(urlUpdateRequest);\n    }\n\n    props.setUpdate(props.update); //console.log(`update vale ${props.update}`)  \n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"details-complete\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"general\",\n        children: /*#__PURE__*/_jsxDEV(List, {\n          sx: {\n            width: '100%',\n            maxWidth: 360,\n            bgcolor: 'background.paper'\n          },\n          children: [/*#__PURE__*/_jsxDEV(ListItem, {\n            children: /*#__PURE__*/_jsxDEV(ListItemText, {\n              primary: type,\n              secondary: data.username\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 247,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 246,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(ListItem, {\n            children: /*#__PURE__*/_jsxDEV(ListItemText, {\n              primary: \"Periodo\",\n              secondary: (props.req.contract.days || props.req.contract.period) + \" days\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 251,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 250,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(ListItem, {\n            children: /*#__PURE__*/_jsxDEV(ListItemText, {\n              primary: \"Precio\",\n              secondary: '$ ' + props.req.contract.price\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 255,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 254,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(ListItem, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 258,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 239,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"group-details\",\n        children: [// Vista de Lessee\n        lessee && evalStatus(props.req.answer.status) && /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            id: \"4\",\n            className: \"red-button\",\n            name: props.idRR,\n            onClick: confirm,\n            children: \"Cancelar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 271,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(AlertDialog, {\n            open: open,\n            cancel: cancel,\n            accept: accept,\n            action: 'cancelar'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 272,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 270,\n          columnNumber: 17\n        }, this) || // Vista de Lessor\n        lessor && evalStatus(props.req.answer.status) && /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n            children: \"Antes de aceptar una solicitud seleccione la fecha correcta\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 283,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(MaterialUIPickers, {\n            value: value,\n            handleChange: handleChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 284,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            id: \"2\",\n            className: \"green-button\",\n            name: props.idRR,\n            onClick: confirm,\n            children: \"Aceptar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 290,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            id: \"3\",\n            className: \"red-button\",\n            name: props.idRR,\n            onClick: confirm,\n            children: \"Rechazar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 292,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(AlertDialog, {\n            open: open,\n            cancel: cancel,\n            accept: accept,\n            action: 'ejecutar esta acción para'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 293,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 282,\n          columnNumber: 17\n        }, this), props.req.answer.status == 'Confirmada' && /*#__PURE__*/_jsxDEV(Link, {\n          href: \"#\",\n          className: \"linkT\",\n          underline: \"hover\",\n          children: 'Ver Renta'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 308,\n          columnNumber: 17\n        }, this), props.req.answer.status == 'En Espera' && /*#__PURE__*/_jsxDEV(Link, {\n          href: \"#\",\n          className: \"linkT\",\n          underline: \"hover\",\n          children: 'Ver Renta'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 315,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 266,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 5\n    }, this), alertVisibility && /*#__PURE__*/_jsxDEV(BasicAlerts, {\n      resSeverity: responseSeverity,\n      responseMessage: responseMessage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 323,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n}\n\n_s(Details, \"hQ79qW8VfNIEzo3xVbZ8gLtAfhs=\");\n\n_c = Details;\n\nvar _c;\n\n$RefreshReg$(_c, \"Details\");","map":{"version":3,"sources":["/home/karina/bedu/System-Rentail/app/src/components/Details2.jsx"],"names":["React","useState","useEffect","Link","List","ListItem","ListItemText","AlertDialog","MaterialUIPickers","BasicAlerts","evalStatus","estatus","Details","props","data","setData","open","setOpen","responseMessage","setResponseMessage","responseSeverity","setSeverity","alertVisibility","setAlertVisibility","activeRRN","setActiveRRN","activeRRI","setActiveRRI","value","setValue","Date","handleChange","newValue","type","typeLess","lessee","lessor","req","id_lessor","id_lessee","URL","getData","url","config","response","fetch","headers","json","err","console","log","addDays","date","days","copy","Number","setDate","getDate","confirm","e","target","name","id","accept","handleClick","cancel","ref","sUser","JSON","parse","localStorage","getItem","token","idRequest","urlUpdateRequest","urlConfirmRequest","numberOfDays","contract","periodo","period","formattedDate","fecha","day","month","getMonth","year","getFullYear","realMonth","realDay","completeDate","startDate","finalDate","ffinalDate","updateStatus","method","resSev","status","message","confirmRequest","dataForRent","body","stringify","setUpdate","update","width","maxWidth","bgcolor","username","price","answer","idRR"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport '../public/styles/details.sass'\nimport Link from '@mui/material/Link';\n\nimport List from '@mui/material/List';\nimport ListItem from '@mui/material/ListItem';\nimport ListItemText from '@mui/material/ListItemText';\n\nimport { AlertDialog } from './Confirm';\nimport { MaterialUIPickers } from './DatePicker'\nimport { BasicAlerts } from './Alert'\n\n\nconst evalStatus = (estatus)=>{\n    return estatus == 'En Espera' ? true : false;\n}\n\nexport function Details(props) {\n    const [ data, setData] = useState([]);\n    const [open, setOpen] = useState(false);\n    const [responseMessage, setResponseMessage] = useState('Holi :)')\n    const [responseSeverity, setSeverity] = useState('success')\n    const [alertVisibility, setAlertVisibility] = useState(false)\n    const [activeRRN, setActiveRRN] = useState('')\n    const [activeRRI, setActiveRRI] = useState('')\n    //console.log(`Este es el id: ${props.idRR}`)\n\n    const [value, setValue] = React.useState(new Date());\n\n    const handleChange = (newValue) => {\n      \n      setValue(newValue);\n      //console.log(newValue)\n\n    };\n\n    let type = ''\n    let typeLess = ''\n    let lessee\n    let lessor\n    if (props.type == 'lessee'){\n        typeLess = props.req.id_lessor \n        type = 'Arrendador'\n        lessee = true\n        lessor = false\n    }\n    else{\n        typeLess = props.req.id_lessee\n        type = 'Arrendatario'\n        lessee = false\n        lessor = true\n    }\n\n\n    URL = `https://system-rentail-api.herokuapp.com/users/${typeLess}`  \n    //console.log(`Dta: ${URL}`)\n    useEffect( () => {\n      \n    const getData = async (url) =>{\n\n        const config = {\n            \"Authorization\": \"Bearer \" + \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjYxN2FlMTRlM2E0MGFhMDAxNjI5NzBhOCIsInVzZXJuYW1lIjoiam5hbWUiLCJleHAiOjE2NDA2MjcwMjIsImlhdCI6MTYzNTQ0MzAyMn0.BxY-c14bn3198yT_tqVmVqywFbXMpdk2Mm2IwGNM0EE\"\n        }        \n\n        //localStorage.setItem('TOKEN', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjYxNGNkZGUzNTFkZTkxMDAxNjJhMGJjMiIsInVzZXJuYW1lIjoibWFyaSIsImV4cCI6MTY0MTQxNDQ2OSwiaWF0IjoxNjM2MjMwNDY5fQ.snhZQ-80qf7TNCnwA-Xo0B9lTUk2q5itMIIKW2Z1v1Y')\n        try{\n            const response = await fetch(url, {\n                headers: config\n              })\n            const data = await response.json()\n\n            //console.log(data)\n            setData(data)\n        } catch(err){\n            console.log(err)\n        }\n    \n    }\n    getData(URL)\n\n}, [])\n\n\nfunction addDays(date, days) {\n    const copy = new Date(Number(date))\n    copy.setDate(date.getDate() + days)\n    return copy\n}\n\n\nconst confirm = (e)=>{\n    //console.log('Botón presionado')\n    setOpen(true);\n\n    //console.log('Nombre del botón:::')\n    //console.log(e.target.name)\n    setActiveRRN(e.target.name)\n    setActiveRRI(e.target.id)\n\n}\n\n\nconst accept = ()=>{\n    //console.log('Aceptado')\n    handleClick()\n    setOpen(false)\n}\n\nconst cancel = () => {\n    //console.log('Cancelado')\n    setOpen(false);\n  };\n\n\n// Queda pendiente lo del target\nconst handleClick = ()=>{\n\n    const ref = activeRRI//e.target.id;\n    console.log(ref);\n    //console.log('Nombre del botón:::')\n    //console.log(activeRRN)\n    //const token = localStorage.getItem('TOKEN');\n    //\n\n    const sUser = JSON.parse(localStorage.getItem('user'))\n    const token = sUser.token;\n    const idRequest = activeRRN//e.target.name\n    const urlUpdateRequest = 'https://system-rentail-api.herokuapp.com/rental-requests/'+ idRequest +'/'+ ref\n    const urlConfirmRequest = 'https://system-rentail-api.herokuapp.com/rents'\n\n    //console.log('Test de Fechas')\n    let numberOfDays = props.req.contract.days; // Aquí poner el total de días del contrato\n    const periodo = props.req.contract.period\n    numberOfDays = !numberOfDays ? periodo : numberOfDays\n    numberOfDays = !numberOfDays? 0: numberOfDays\n    const formattedDate = (date) =>{\n        const fecha = date\n\n        const day = fecha.getDate()\n        const month = fecha.getMonth() + 1\n        const year = fecha.getFullYear()\n\n        const  realMonth = month < 10 ? `0${month}` : `${month}`\n        const realDay = day < 10 ? `0${day}` : `${day}`\n        const completeDate = `${year},${realMonth},${realDay}`\n        \n        return completeDate\n    }\n    // De la fecha seleccionada empieza a correr al siguiente día\n    const date = addDays(value, 1)\n    console.log(date)\n\n    const startDate = formattedDate(date)\n    \n    console.log(startDate)\n\n    const finalDate = addDays(date, numberOfDays);\n    const ffinalDate = formattedDate(finalDate)\n    console.log(ffinalDate)\n    console.log('End de Fechas')\n\n    const updateStatus = async (url) => {\n        const config = {\n            method: \"PUT\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                \"Authorization\": \"Bearer \" + token\n            }    \n        }\n\n        try{\n            const response = await fetch(url, config);\n            console.log(response);\n            const data = await response.json();\n            const resSev = response.status == '200' ? 'success' : 'error'\n            setSeverity(resSev)\n            setAlertVisibility(true)\n            setResponseMessage(data.message)\n            //console.log(data)\n        }\n        catch(err){\n            console.log(err)\n        }\n    }\n    // Esta se llama solo en caso de que quiera confirmar\n    const confirmRequest = async (url) => {\n\n        const dataForRent = { \n                \"id_rentalRequest\": `${activeRRN}`,\n                \"start_date\":`${startDate}`,\n                \"end_date\":`${ffinalDate}`\n        }\n        console.log('Datos a Enviar: ')\n        console.log(dataForRent)\n\n        const config = {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                \"Authorization\": \"Bearer \" + token\n            },\n            body: JSON.stringify(dataForRent)    \n        }\n\n        try{\n            \n            const response = await fetch(url, config)\n            const data = await response.json()\n\n            const resSev = response.status == '200' ? 'success' : 'error'\n            setSeverity(resSev)\n            setAlertVisibility(true)\n            setResponseMessage(data.message)\n            //console.log(data)\n   \n        }\n        catch(err){\n            console.log(err)\n        }\n    }\n    // Si lo que quiere es confirmar entonces se llama a crear Renta, sino, simplemente actualiza estatus\n    if (ref == '2'){\n        console.log('Quiere confirmar')\n        confirmRequest(urlConfirmRequest)\n    }\n    else{\n        updateStatus(urlUpdateRequest)\n    }\n    props.setUpdate(props.update)\n    //console.log(`update vale ${props.update}`)  \n\n}\n\n \n  return (\n    <>\n    <div id =\"details-complete\">\n        <div id =\"general\">\n            <List\n            sx={{\n                width: '100%',\n                maxWidth: 360,\n                bgcolor: 'background.paper',\n            }}\n            >\n            <ListItem>\n                <ListItemText primary={type} secondary={data.username} />\n            </ListItem>\n\n            <ListItem>\n                <ListItemText primary=\"Periodo\" secondary={(props.req.contract.days || props.req.contract.period ) + \" days\"} />\n            </ListItem>\n\n            <ListItem>\n                <ListItemText primary=\"Precio\" secondary={'$ '+ props.req.contract.price} />\n            </ListItem>\n\n            <ListItem>\n            \n            </ListItem>\n            \n            </List>\n        </div>\n\n    \n        <div id=\"group-details\">\n            {\n                // Vista de Lessee\n                (lessee && evalStatus(props.req.answer.status) && \n                <div>\n                    <button id='4' className = \"red-button\" name={props.idRR} onClick={confirm}>Cancelar</button>\n                    <AlertDialog\n                        open={open}\n                        cancel={cancel}\n                        accept ={accept}\n                        action = {'cancelar'}\n                    ></AlertDialog>    \n                </div>)\n                ||\n                // Vista de Lessor\n                (lessor && evalStatus(props.req.answer.status) &&\n                <div>\n                    <h6>Antes de aceptar una solicitud seleccione la fecha correcta</h6> \n                    <MaterialUIPickers\n                        value = {value}\n                        handleChange = {handleChange}\n                    ></MaterialUIPickers>\n                         \n                                   \n                    <button id='2' className = \"green-button\" name={props.idRR} onClick={confirm}>Aceptar</button>\n                    \n                    <button id='3' className = \"red-button\" name={props.idRR} onClick={confirm}>Rechazar</button>\n                    <AlertDialog\n                        open={open}\n                        cancel={cancel}\n                        accept ={accept}\n                        action = {'ejecutar esta acción para'}\n                    ></AlertDialog>\n\n                </div>\n                )   \n            }\n\n\n            {\n                props.req.answer.status == 'Confirmada'\n                &&\n                <Link href=\"#\" className=\"linkT\" underline=\"hover\">\n                {'Ver Renta'} \n                </Link>\n            }\n            {\n                props.req.answer.status == 'En Espera'\n                &&\n                <Link href=\"#\" className=\"linkT\" underline=\"hover\">\n                {'Ver Renta'} \n                </Link>\n            }\n        </div>\n    </div>\n    {\n        alertVisibility && \n        <BasicAlerts \n            resSeverity={responseSeverity} \n            responseMessage={responseMessage} >\n        </BasicAlerts>\n    }\n    </>\n    \n  );\n}"]},"metadata":{},"sourceType":"module"}